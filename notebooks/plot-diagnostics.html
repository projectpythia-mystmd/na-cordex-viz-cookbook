
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Make Diagnostic Plots for NA-CORDEX Zarr Stores &#8212; My Jupyter Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=c54c090a" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/plot-diagnostics';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="How to Cite This Cookbook" href="how-to-cite.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
  
    <p class="title logo__title">My Jupyter Book</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    NA-CORDEX Data Visualization Cookbook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Preamble</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="how-to-cite.html">How to Cite This Cookbook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Plot NA-CORDEX Data Diagnostics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Make Diagnostic Plots for NA-CORDEX Zarr Stores</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/plot-diagnostics.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Make Diagnostic Plots for NA-CORDEX Zarr Stores</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-user-options">Select User Options</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-cloud-storage-amazon-aws-or-ncar-cloud">Choose Cloud Storage (Amazon AWS or NCAR Cloud)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-whether-to-truncate-data-for-resource-limited-computers">Choose whether to truncate data for resource-limited computers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-whether-to-use-a-pbs-scheduler">Choose whether to use a PBS Scheduler</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-whether-to-use-dask-gateway">Choose whether to use Dask Gateway</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-and-connect-to-dask-distributed-cluster">Create and Connect to Dask Distributed Cluster</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-and-obtain-data-using-an-intake-catalog">Find and Obtain Data Using an Intake Catalog</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-intake-catalog-url-and-storage-access-options">Define the Intake Catalog URL and Storage Access Options</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#open-catalog-and-produce-a-content-summary">Open catalog and produce a content summary</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data-into-xarray-using-the-catalog">Load data into xarray using the catalog</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-for-subsetting-and-plotting">Functions for Subsetting and Plotting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-function-to-create-a-single-map-plot">Helper Function to Create a Single Map Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-function-for-finding-dates-with-available-data">Helper Function for Finding Dates with Available Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-function-for-truncating-data-slices">Helper Function for Truncating Data Slices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-producing-maps-of-first-middle-and-final-timesteps">Function Producing Maps of First, Middle, and Final Timesteps</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-producing-statistical-map-plots">Function Producing Statistical Map Plots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-producing-time-series-plots">Function Producing Time Series Plots</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#produce-diagnostic-plots">Produce Diagnostic Plots</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-first-middle-and-final-timesteps-for-several-output-runs-less-compute-intensive">Plot First, Middle, and Final Timesteps for Several Output Runs (less compute intensive)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-save-figure-to-a-png-file">Optional: Save figure to a PNG file</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-statistical-map-plots-for-several-output-runs-more-compute-intensive">Create Statistical Map Plots for Several Output Runs (more compute intensive)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Optional: Save figure to a PNG file</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-time-series-for-several-output-runs-more-compute-intensive">Plot Time Series for Several Output Runs (more compute intensive)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Optional: Save figure to a PNG file</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#release-the-workers">Release the workers.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#show-which-python-package-versions-were-used">Show which python package versions were used</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="make-diagnostic-plots-for-na-cordex-zarr-stores">
<h1>Make Diagnostic Plots for NA-CORDEX Zarr Stores<a class="headerlink" href="#make-diagnostic-plots-for-na-cordex-zarr-stores" title="Link to this heading">#</a></h1>
<p>The NA-CORDEX data archive contains output from regional climate models (RCMs) run over a domain covering most of North America using boundary conditions from global climate model (GCM) simulations in the CMIP5 archive.  It differs from many climate datasets by combining runs from many independently derived simulations.  The usage of Zarr, Xarray, and Intake-ESM help simplify the problem of examining these disparate runs.</p>
<p>See the <a class="reference internal" href="../README.html"><span class="std std-doc">README</span></a> file for more pointers and information on the NA-CORDEX data archive.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>This cookbook provides useful methods for summarizing data values in large climate datasets.   It clearly shows where data have extreme values and where data are missing; this can be useful for validating that the data were gathered and stored correctly.   While this cookbook is specifically designed to examine any portion of the NA-CORDEX dataset using an intake catalog, the code can be adapted straightforwardly to other datasets that can be loaded via <code class="docutils literal notranslate"><span class="pre">xarray</span></code>.</p>
<p>Topics covered in this notebook include:</p>
<ol class="arabic simple">
<li><p>Different Ways to Create and Connect to Dask Distributed Cluster</p></li>
<li><p>How to Find and Obtain Data Using an Intake-ESM Catalog</p></li>
<li><p>How to Create Various Statistical Summary Plots with matplotlib</p></li>
</ol>
</section>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">#</a></h2>
<p>To more fully understand how the code in this notebook works, users are encouraged to explore the following introductory articles.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Concepts</p></th>
<th class="head"><p>Importance</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://foundations.projectpythia.org/core/xarray/xarray-intro.html">Intro to Xarray</a></p></td>
<td><p>Helpful</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://foundations.projectpythia.org/core/xarray/dask-arrays-xarray.html">Dask Arrays with Xarray</a></p></td>
<td><p>Helpful</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://foundations.projectpythia.org/core/data-formats/netcdf-cf.html">Understanding of Zarr Metadata</a></p></td>
<td><p>Helpful</p></td>
<td><p>Familiarity with metadata structure</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://foundations.projectpythia.org/core/matplotlib/matplotlib-basics.html">Understanding of Matplotlib</a></p></td>
<td><p>Helpful</p></td>
<td><p>Familiarity with plot elements in matplotlib</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p><strong>Time to learn</strong>: 45 minutes</p></li>
</ul>
<p><strong>Note</strong>: This notebook contains optional choices for running on NCAR supercomputers.   These can be ignored for users running outside of the NCAR domain.</p>
</section>
<hr class="docutils" />
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Link to this heading">#</a></h2>
<p>The main python packages used are <code class="docutils literal notranslate"><span class="pre">xarray</span></code>, <code class="docutils literal notranslate"><span class="pre">intake-esm</span></code>, <code class="docutils literal notranslate"><span class="pre">dask</span></code>, and <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p>
<p>Because some of the CORDEX data have been interpolated from a Lambert Conformal grid onto a rectangular grid for ease of use, there can be many missing values on the edges of the interpolated grid. For this reason, we also turn off warnings complaining about missing values in the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">intake</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ast</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Ignore dask-numpy warnings about finding missing values in the data</span>
<span class="o">%</span><span class="k">env</span> PYTHONWARNINGS=ignore
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>env: PYTHONWARNINGS=ignore
</pre></div>
</div>
</div>
</div>
</section>
<section id="select-user-options">
<h2>Select User Options<a class="headerlink" href="#select-user-options" title="Link to this heading">#</a></h2>
<p>Users may choose between:</p>
<ul class="simple">
<li><p>Cloud storage provider (Amazon AWS or NCAR),</p></li>
<li><p>Whether to truncate the data if running on a resource-limited computer,</p></li>
<li><p>Whether to obtain a Dask cluster from a PBS Scheduler or via the Dask Gateway package.</p></li>
</ul>
<p><strong>Note</strong>: Using the NCAR cloud storage system requires a login account on an NCAR HPC computer.</p>
<section id="choose-cloud-storage-amazon-aws-or-ncar-cloud">
<h3>Choose Cloud Storage (Amazon AWS or NCAR Cloud)<a class="headerlink" href="#choose-cloud-storage-amazon-aws-or-ncar-cloud" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># If True,  use NCAR Cloud Storage.   Requires an NCAR user account.</span>
<span class="c1"># If False, use AWS  Cloud Storage.</span>

<span class="n">USE_NCAR_CLOUD</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="choose-whether-to-truncate-data-for-resource-limited-computers">
<h3>Choose whether to truncate data for resource-limited computers<a class="headerlink" href="#choose-whether-to-truncate-data-for-resource-limited-computers" title="Link to this heading">#</a></h3>
<p>When running this notebook where compute resources are limited, or data transfer rates are slow, set <code class="docutils literal notranslate"><span class="pre">TRUNCATE_DATA</span></code> to True.   This will limit time ranges to 3 years from the start of a chosen NA-CORDEX scenario.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TRUNCATE_DATA</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="choose-whether-to-use-a-pbs-scheduler">
<h3>Choose whether to use a PBS Scheduler<a class="headerlink" href="#choose-whether-to-use-a-pbs-scheduler" title="Link to this heading">#</a></h3>
<p>If running on a HPC computer with a PBS Scheduler, set to True.  Otherwise, set to False.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">USE_PBS_SCHEDULER</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="choose-whether-to-use-dask-gateway">
<h3>Choose whether to use Dask Gateway<a class="headerlink" href="#choose-whether-to-use-dask-gateway" title="Link to this heading">#</a></h3>
<p>If running on Jupyter server with Dask Gateway configured, set to True.  Otherwise, set to False.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">USE_DASK_GATEWAY</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="create-and-connect-to-dask-distributed-cluster">
<h2>Create and Connect to Dask Distributed Cluster<a class="headerlink" href="#create-and-connect-to-dask-distributed-cluster" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_gateway_cluster</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Create cluster through dask_gateway</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dask_gateway</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gateway</span>

    <span class="n">gateway</span> <span class="o">=</span> <span class="n">Gateway</span><span class="p">()</span>
    <span class="n">cluster</span> <span class="o">=</span> <span class="n">gateway</span><span class="o">.</span><span class="n">new_cluster</span><span class="p">()</span>
    <span class="n">cluster</span><span class="o">.</span><span class="n">adapt</span><span class="p">(</span><span class="n">minimum</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cluster</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_pbs_cluster</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Create cluster through dask_jobqueue</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dask_jobqueue</span><span class="w"> </span><span class="kn">import</span> <span class="n">PBSCluster</span>
    
    <span class="k">if</span> <span class="n">TRUNCATE_DATA</span><span class="p">:</span>
        <span class="n">num_jobs</span> <span class="o">=</span> <span class="mi">4</span> 
        <span class="n">walltime</span> <span class="o">=</span> <span class="s1">&#39;0:10:00&#39;</span> 
        <span class="n">memory</span> <span class="o">=</span> <span class="s1">&#39;2GB&#39;</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">num_jobs</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="n">walltime</span> <span class="o">=</span> <span class="s1">&#39;0:20:00&#39;</span>
        <span class="n">memory</span> <span class="o">=</span> <span class="s1">&#39;10GB&#39;</span> 

    <span class="n">cluster</span> <span class="o">=</span> <span class="n">PBSCluster</span><span class="p">(</span><span class="n">cores</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">processes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">walltime</span><span class="o">=</span><span class="n">walltime</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="n">memory</span><span class="p">,</span> <span class="n">queue</span><span class="o">=</span><span class="s1">&#39;casper&#39;</span><span class="p">,</span> 
                         <span class="n">resource_spec</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;select=1:ncpus=1:mem=</span><span class="si">{</span><span class="n">memory</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,)</span>
    <span class="n">cluster</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">jobs</span><span class="o">=</span><span class="n">num_jobs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cluster</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_local_cluster</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Create cluster using the Jupyter server&#39;s resources</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">distributed</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalCluster</span>
    <span class="n">cluster</span> <span class="o">=</span> <span class="n">LocalCluster</span><span class="p">()</span>    

    <span class="k">if</span> <span class="n">TRUNCATE_DATA</span><span class="p">:</span>
        <span class="n">cluster</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cluster</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cluster</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtain dask cluster in one of three ways</span>

<span class="k">if</span> <span class="n">USE_PBS_SCHEDULER</span><span class="p">:</span>
    <span class="n">cluster</span> <span class="o">=</span> <span class="n">get_pbs_cluster</span><span class="p">()</span>
<span class="k">elif</span> <span class="n">USE_DASK_GATEWAY</span><span class="p">:</span>
    <span class="n">cluster</span> <span class="o">=</span> <span class="n">get_gateway_cluster</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">cluster</span> <span class="o">=</span> <span class="n">get_local_cluster</span><span class="p">()</span>

<span class="c1"># Connect to cluster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">distributed</span><span class="w"> </span><span class="kn">import</span> <span class="n">Client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span>

<span class="c1"># Display cluster dashboard URL</span>
<span class="n">cluster</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output">
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;">
    </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px; margin-top: 0px;">LocalCluster</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">386b9368</p>
        <table style="width: 100%; text-align: left;">
            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                </td>
                <td style="text-align: left;">
                    <strong>Workers:</strong> 4
                </td>
            </tr>
            <tr>
                <td style="text-align: left;">
                    <strong>Total threads:</strong> 4
                </td>
                <td style="text-align: left;">
                    <strong>Total memory:</strong> 15.62 GiB
                </td>
            </tr>
            
            <tr>
    <td style="text-align: left;"><strong>Status:</strong> running</td>
    <td style="text-align: left;"><strong>Using processes:</strong> True</td>
</tr>

            
        </table>

        <details>
            <summary style="margin-bottom: 20px;">
                <h3 style="display: inline;">Scheduler Info</h3>
            </summary>

            <div style="">
    <div>
        <div style="width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;"> </div>
        <div style="margin-left: 48px;">
            <h3 style="margin-bottom: 0px;">Scheduler</h3>
            <p style="color: #9D9D9D; margin-bottom: 0px;">Scheduler-62f2c069-861d-4353-a9ac-4c5f4ce3491c</p>
            <table style="width: 100%; text-align: left;">
                <tr>
                    <td style="text-align: left;">
                        <strong>Comm:</strong> tcp://127.0.0.1:33629
                    </td>
                    <td style="text-align: left;">
                        <strong>Workers:</strong> 0 
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                    </td>
                    <td style="text-align: left;">
                        <strong>Total threads:</strong> 0
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Started:</strong> Just now
                    </td>
                    <td style="text-align: left;">
                        <strong>Total memory:</strong> 0 B
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <details style="margin-left: 48px;">
        <summary style="margin-bottom: 20px;">
            <h3 style="display: inline;">Workers</h3>
        </summary>

        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 0</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:43123
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:44623/status" target="_blank">http://127.0.0.1:44623/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 3.91 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:37511
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-rfvf6u0y
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 1</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:34719
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:43265/status" target="_blank">http://127.0.0.1:43265/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 3.91 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:35321
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-qc05lotz
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 2</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:45247
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:38595/status" target="_blank">http://127.0.0.1:38595/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 3.91 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:37643
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-e65qvdm1
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 3</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:40161
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:40903/status" target="_blank">http://127.0.0.1:40903/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 3.91 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:37071
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-71ec3exl
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        

    </details>
</div>

        </details>
    </div>
</div></div></div>
</div>
<p>☝️ Link to Dask dashboard will appear above.</p>
</section>
<section id="find-and-obtain-data-using-an-intake-catalog">
<h2>Find and Obtain Data Using an Intake Catalog<a class="headerlink" href="#find-and-obtain-data-using-an-intake-catalog" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://intake-esm.readthedocs.io/en/stable/">Intake-esm Documentation</a></p></li>
</ul>
<section id="define-the-intake-catalog-url-and-storage-access-options">
<h3>Define the Intake Catalog URL and Storage Access Options<a class="headerlink" href="#define-the-intake-catalog-url-and-storage-access-options" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">USE_NCAR_CLOUD</span><span class="p">:</span>
    <span class="n">catalog_url</span> <span class="o">=</span> <span class="s2">&quot;https://stratus.ucar.edu/ncar-na-cordex/catalogs/aws-na-cordex.json&quot;</span>
    <span class="n">storage_options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;anon&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;client_kwargs&#39;</span><span class="p">:{</span><span class="s2">&quot;endpoint_url&quot;</span><span class="p">:</span><span class="s2">&quot;https://stratus.ucar.edu/&quot;</span><span class="p">}}</span>
                     
<span class="k">else</span><span class="p">:</span>
    <span class="n">catalog_url</span> <span class="o">=</span> <span class="s2">&quot;https://ncar-na-cordex.s3-us-west-2.amazonaws.com/catalogs/aws-na-cordex.json&quot;</span>
    <span class="n">storage_options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;anon&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="open-catalog-and-produce-a-content-summary">
<h3>Open catalog and produce a content summary<a class="headerlink" href="#open-catalog-and-produce-a-content-summary" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Have the catalog interpret the &quot;na-cordex-models&quot; column as a list of values, as opposed to single values.</span>
<span class="n">col</span> <span class="o">=</span> <span class="n">intake</span><span class="o">.</span><span class="n">open_esm_datastore</span><span class="p">(</span><span class="n">catalog_url</span><span class="p">,</span> <span class="n">read_csv_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;converters&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;na-cordex-models&quot;</span><span class="p">:</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">}},)</span>
<span class="n">col</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p><strong>aws-na-cordex catalog with 330 dataset(s) from 330 asset(s)</strong>:</p> <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>variable</th>
      <td>15</td>
    </tr>
    <tr>
      <th>standard_name</th>
      <td>10</td>
    </tr>
    <tr>
      <th>long_name</th>
      <td>18</td>
    </tr>
    <tr>
      <th>units</th>
      <td>10</td>
    </tr>
    <tr>
      <th>spatial_domain</th>
      <td>1</td>
    </tr>
    <tr>
      <th>grid</th>
      <td>2</td>
    </tr>
    <tr>
      <th>spatial_resolution</th>
      <td>2</td>
    </tr>
    <tr>
      <th>scenario</th>
      <td>6</td>
    </tr>
    <tr>
      <th>start_time</th>
      <td>3</td>
    </tr>
    <tr>
      <th>end_time</th>
      <td>4</td>
    </tr>
    <tr>
      <th>frequency</th>
      <td>1</td>
    </tr>
    <tr>
      <th>vertical_levels</th>
      <td>1</td>
    </tr>
    <tr>
      <th>bias_correction</th>
      <td>3</td>
    </tr>
    <tr>
      <th>na-cordex-models</th>
      <td>26</td>
    </tr>
    <tr>
      <th>path</th>
      <td>330</td>
    </tr>
    <tr>
      <th>derived_variable</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the first few lines of the catalog</span>
<span class="n">col</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>standard_name</th>
      <th>long_name</th>
      <th>units</th>
      <th>spatial_domain</th>
      <th>grid</th>
      <th>spatial_resolution</th>
      <th>scenario</th>
      <th>start_time</th>
      <th>end_time</th>
      <th>frequency</th>
      <th>vertical_levels</th>
      <th>bias_correction</th>
      <th>na-cordex-models</th>
      <th>path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>hurs</td>
      <td>relative_humidity</td>
      <td>Near-Surface Relative Humidity</td>
      <td>%</td>
      <td>north_america</td>
      <td>NAM-22i</td>
      <td>0.25 deg</td>
      <td>eval</td>
      <td>1979-01-01T12:00:00</td>
      <td>2014-12-31T12:00:00</td>
      <td>day</td>
      <td>1</td>
      <td>raw</td>
      <td>[ERA-Int.CRCM5-UQAM, ERA-Int.CRCM5-OUR, ERA-In...</td>
      <td>s3://ncar-na-cordex/day/hurs.eval.day.NAM-22i....</td>
    </tr>
    <tr>
      <th>1</th>
      <td>hurs</td>
      <td>relative_humidity</td>
      <td>Near-Surface Relative Humidity</td>
      <td>%</td>
      <td>north_america</td>
      <td>NAM-44i</td>
      <td>0.50 deg</td>
      <td>eval</td>
      <td>1979-01-01T12:00:00</td>
      <td>2015-12-31T12:00:00</td>
      <td>day</td>
      <td>1</td>
      <td>raw</td>
      <td>[ERA-Int.CRCM5-UQAM, ERA-Int.RegCM4, ERA-Int.H...</td>
      <td>s3://ncar-na-cordex/day/hurs.eval.day.NAM-44i....</td>
    </tr>
    <tr>
      <th>2</th>
      <td>hurs</td>
      <td>relative_humidity</td>
      <td>Near-Surface Relative Humidity</td>
      <td>%</td>
      <td>north_america</td>
      <td>NAM-22i</td>
      <td>0.25 deg</td>
      <td>hist-rcp45</td>
      <td>1949-01-01T12:00:00</td>
      <td>2100-12-31T12:00:00</td>
      <td>day</td>
      <td>1</td>
      <td>mbcn-Daymet</td>
      <td>[CanESM2.CanRCM4]</td>
      <td>s3://ncar-na-cordex/day/hurs.hist-rcp45.day.NA...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>hurs</td>
      <td>relative_humidity</td>
      <td>Near-Surface Relative Humidity</td>
      <td>%</td>
      <td>north_america</td>
      <td>NAM-22i</td>
      <td>0.25 deg</td>
      <td>hist-rcp45</td>
      <td>1949-01-01T12:00:00</td>
      <td>2100-12-31T12:00:00</td>
      <td>day</td>
      <td>1</td>
      <td>mbcn-gridMET</td>
      <td>[CanESM2.CanRCM4]</td>
      <td>s3://ncar-na-cordex/day/hurs.hist-rcp45.day.NA...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>hurs</td>
      <td>relative_humidity</td>
      <td>Near-Surface Relative Humidity</td>
      <td>%</td>
      <td>north_america</td>
      <td>NAM-22i</td>
      <td>0.25 deg</td>
      <td>hist-rcp45</td>
      <td>1949-01-01T12:00:00</td>
      <td>2100-12-31T12:00:00</td>
      <td>day</td>
      <td>1</td>
      <td>raw</td>
      <td>[GFDL-ESM2M.CRCM5-OUR, CanESM2.CRCM5-OUR, CanE...</td>
      <td>s3://ncar-na-cordex/day/hurs.hist-rcp45.day.NA...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>hurs</td>
      <td>relative_humidity</td>
      <td>Near-Surface Relative Humidity</td>
      <td>%</td>
      <td>north_america</td>
      <td>NAM-44i</td>
      <td>0.50 deg</td>
      <td>hist-rcp45</td>
      <td>1949-01-01T12:00:00</td>
      <td>2100-12-31T12:00:00</td>
      <td>day</td>
      <td>1</td>
      <td>mbcn-Daymet</td>
      <td>[MPI-ESM-LR.CRCM5-UQAM, CanESM2.CRCM5-UQAM, EC...</td>
      <td>s3://ncar-na-cordex/day/hurs.hist-rcp45.day.NA...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>hurs</td>
      <td>relative_humidity</td>
      <td>Near-Surface Relative Humidity</td>
      <td>%</td>
      <td>north_america</td>
      <td>NAM-44i</td>
      <td>0.50 deg</td>
      <td>hist-rcp45</td>
      <td>1949-01-01T12:00:00</td>
      <td>2100-12-31T12:00:00</td>
      <td>day</td>
      <td>1</td>
      <td>mbcn-gridMET</td>
      <td>[MPI-ESM-LR.CRCM5-UQAM, CanESM2.CRCM5-UQAM, EC...</td>
      <td>s3://ncar-na-cordex/day/hurs.hist-rcp45.day.NA...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>hurs</td>
      <td>relative_humidity</td>
      <td>Near-Surface Relative Humidity</td>
      <td>%</td>
      <td>north_america</td>
      <td>NAM-44i</td>
      <td>0.50 deg</td>
      <td>hist-rcp45</td>
      <td>1949-01-01T12:00:00</td>
      <td>2100-12-31T12:00:00</td>
      <td>day</td>
      <td>1</td>
      <td>raw</td>
      <td>[MPI-ESM-LR.CRCM5-UQAM, CanESM2.CRCM5-UQAM, EC...</td>
      <td>s3://ncar-na-cordex/day/hurs.hist-rcp45.day.NA...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>hurs</td>
      <td>relative_humidity</td>
      <td>Near-Surface Relative Humidity</td>
      <td>%</td>
      <td>north_america</td>
      <td>NAM-22i</td>
      <td>0.25 deg</td>
      <td>hist-rcp85</td>
      <td>1949-01-01T12:00:00</td>
      <td>2100-12-31T12:00:00</td>
      <td>day</td>
      <td>1</td>
      <td>mbcn-Daymet</td>
      <td>[MPI-ESM-MR.CRCM5-UQAM, GEMatm-Can.CRCM5-UQAM,...</td>
      <td>s3://ncar-na-cordex/day/hurs.hist-rcp85.day.NA...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>hurs</td>
      <td>relative_humidity</td>
      <td>Near-Surface Relative Humidity</td>
      <td>%</td>
      <td>north_america</td>
      <td>NAM-22i</td>
      <td>0.25 deg</td>
      <td>hist-rcp85</td>
      <td>1949-01-01T12:00:00</td>
      <td>2100-12-31T12:00:00</td>
      <td>day</td>
      <td>1</td>
      <td>mbcn-gridMET</td>
      <td>[MPI-ESM-MR.CRCM5-UQAM, GEMatm-Can.CRCM5-UQAM,...</td>
      <td>s3://ncar-na-cordex/day/hurs.hist-rcp85.day.NA...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Produce a catalog content summary.</span>

<span class="n">uniques</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="s2">&quot;scenario&quot;</span><span class="p">,</span> <span class="s2">&quot;grid&quot;</span><span class="p">,</span> <span class="s2">&quot;na-cordex-models&quot;</span><span class="p">,</span> <span class="s2">&quot;bias_correction&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">uniques</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>variable: [&#39;hurs&#39;, &#39;huss&#39;, &#39;pr&#39;, &#39;prec&#39;, &#39;ps&#39;, &#39;rsds&#39;, &#39;sfcWind&#39;, &#39;tas&#39;, &#39;tasmax&#39;, &#39;tasmin&#39;, &#39;temp&#39;, &#39;tmax&#39;, &#39;tmin&#39;, &#39;uas&#39;, &#39;vas&#39;]

scenario: [&#39;eval&#39;, &#39;hist-rcp45&#39;, &#39;hist-rcp85&#39;, &#39;hist&#39;, &#39;rcp45&#39;, &#39;rcp85&#39;]

grid: [&#39;NAM-22i&#39;, &#39;NAM-44i&#39;]

na-cordex-models: [&#39;ERA-Int.CRCM5-UQAM&#39;, &#39;ERA-Int.CRCM5-OUR&#39;, &#39;ERA-Int.RegCM4&#39;, &#39;ERA-Int.CanRCM4&#39;, &#39;ERA-Int.WRF&#39;, &#39;ERA-Int.HIRHAM5&#39;, &#39;ERA-Int.RCA4&#39;, &#39;CanESM2.CanRCM4&#39;, &#39;GFDL-ESM2M.CRCM5-OUR&#39;, &#39;CanESM2.CRCM5-OUR&#39;, &#39;MPI-ESM-LR.CRCM5-UQAM&#39;, &#39;CanESM2.CRCM5-UQAM&#39;, &#39;EC-EARTH.HIRHAM5&#39;, &#39;EC-EARTH.RCA4&#39;, &#39;CanESM2.RCA4&#39;, &#39;MPI-ESM-MR.CRCM5-UQAM&#39;, &#39;GEMatm-Can.CRCM5-UQAM&#39;, &#39;GEMatm-MPI.CRCM5-UQAM&#39;, &#39;HadGEM2-ES.RegCM4&#39;, &#39;GFDL-ESM2M.RegCM4&#39;, &#39;MPI-ESM-LR.RegCM4&#39;, &#39;HadGEM2-ES.WRF&#39;, &#39;GFDL-ESM2M.WRF&#39;, &#39;MPI-ESM-LR.WRF&#39;, &#39;CNRM-CM5.CRCM5-OUR&#39;, &#39;MPI-ESM-LR.CRCM5-OUR&#39;]

bias_correction: [&#39;raw&#39;, &#39;mbcn-Daymet&#39;, &#39;mbcn-gridMET&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-data-into-xarray-using-the-catalog">
<h3>Load data into xarray using the catalog<a class="headerlink" href="#load-data-into-xarray-using-the-catalog" title="Link to this heading">#</a></h3>
<p>Choose any combination of variable, grid, scenario, and bias correction listed in the catalog.</p>
<p>Below we choose the variable ‘tmax’ (Maximum Daily Surface Temperature) as a default for its ease of interpretation.   For this example, we also choose a lower-resolution grid and the scenario with the shortest time range (15 years) to reduce the default data processing requirements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_var</span> <span class="o">=</span> <span class="s1">&#39;tmax&#39;</span>

<span class="n">col_subset</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
    <span class="n">variable</span><span class="o">=</span><span class="n">data_var</span><span class="p">,</span>
    <span class="n">grid</span><span class="o">=</span><span class="s2">&quot;NAM-44i&quot;</span><span class="p">,</span>
    <span class="n">scenario</span><span class="o">=</span><span class="s2">&quot;eval&quot;</span><span class="p">,</span>
    <span class="n">bias_correction</span><span class="o">=</span><span class="s2">&quot;raw&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">col_subset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p><strong>aws-na-cordex catalog with 1 dataset(s) from 1 asset(s)</strong>:</p> <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>variable</th>
      <td>1</td>
    </tr>
    <tr>
      <th>standard_name</th>
      <td>1</td>
    </tr>
    <tr>
      <th>long_name</th>
      <td>1</td>
    </tr>
    <tr>
      <th>units</th>
      <td>1</td>
    </tr>
    <tr>
      <th>spatial_domain</th>
      <td>1</td>
    </tr>
    <tr>
      <th>grid</th>
      <td>1</td>
    </tr>
    <tr>
      <th>spatial_resolution</th>
      <td>1</td>
    </tr>
    <tr>
      <th>scenario</th>
      <td>1</td>
    </tr>
    <tr>
      <th>start_time</th>
      <td>1</td>
    </tr>
    <tr>
      <th>end_time</th>
      <td>1</td>
    </tr>
    <tr>
      <th>frequency</th>
      <td>1</td>
    </tr>
    <tr>
      <th>vertical_levels</th>
      <td>1</td>
    </tr>
    <tr>
      <th>bias_correction</th>
      <td>1</td>
    </tr>
    <tr>
      <th>na-cordex-models</th>
      <td>6</td>
    </tr>
    <tr>
      <th>path</th>
      <td>1</td>
    </tr>
    <tr>
      <th>derived_variable</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verify our query matches at least one entry in the catalog.</span>

<span class="n">col_subset</span><span class="o">.</span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>standard_name</th>
      <th>long_name</th>
      <th>units</th>
      <th>spatial_domain</th>
      <th>grid</th>
      <th>spatial_resolution</th>
      <th>scenario</th>
      <th>start_time</th>
      <th>end_time</th>
      <th>frequency</th>
      <th>vertical_levels</th>
      <th>bias_correction</th>
      <th>na-cordex-models</th>
      <th>path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>tmax</td>
      <td>air_temperature</td>
      <td>Daily Maximum Near-Surface Air Temperature</td>
      <td>degC</td>
      <td>north_america</td>
      <td>NAM-44i</td>
      <td>0.50 deg</td>
      <td>eval</td>
      <td>1979-01-01T12:00:00</td>
      <td>2015-12-31T12:00:00</td>
      <td>day</td>
      <td>1</td>
      <td>raw</td>
      <td>[ERA-Int.CRCM5-UQAM, ERA-Int.RegCM4, ERA-Int.H...</td>
      <td>s3://ncar-na-cordex/day/tmax.eval.day.NAM-44i....</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load catalog entries for subset into a dictionary of xarray datasets, and open the first one.</span>

<span class="n">dsets</span> <span class="o">=</span> <span class="n">col_subset</span><span class="o">.</span><span class="n">to_dataset_dict</span><span class="p">(</span>
    <span class="n">xarray_open_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;consolidated&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span> <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Dataset dictionary keys:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">dsets</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Load the first dataset and display a summary.</span>
<span class="n">dataset_key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dsets</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">store_name</span> <span class="o">=</span> <span class="n">dataset_key</span> <span class="o">+</span> <span class="s2">&quot;.zarr&quot;</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">dsets</span><span class="p">[</span><span class="n">dataset_key</span><span class="p">]</span>
<span class="n">ds</span>

<span class="c1"># Note that the xarray dataset summary includes a &#39;member_id&#39; coordinate, which is a renaming of the </span>
<span class="c1"># &#39;na-cordex-models&#39; column in the catalog.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--&gt; The keys in the returned dictionary of datasets are constructed as follows:
	&#39;variable.frequency.scenario.grid.bias_correction&#39;
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='1' class='' max='1' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [1/1 00:02&lt;00:00]
    </div>
    </div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset dictionary keys:
 dict_keys([&#39;tmax.day.eval.NAM-44i.raw&#39;])
</pre></div>
</div>
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 13GB
Dimensions:    (lat: 129, lon: 300, member_id: 6, time: 13514, bnds: 2)
Coordinates:
  * lat        (lat) float64 1kB 12.25 12.75 13.25 13.75 ... 75.25 75.75 76.25
  * lon        (lon) float64 2kB -171.8 -171.2 -170.8 ... -23.25 -22.75 -22.25
  * member_id  (member_id) &lt;U18 432B &#x27;ERA-Int.CRCM5-UQAM&#x27; ... &#x27;ERA-Int.WRF&#x27;
  * time       (time) datetime64[ns] 108kB 1979-01-01T12:00:00 ... 2015-12-31...
    time_bnds  (time, bnds) datetime64[ns] 216kB dask.array&lt;chunksize=(13514, 2), meta=np.ndarray&gt;
Dimensions without coordinates: bnds
Data variables:
    tmax       (member_id, time, lat, lon) float32 13GB dask.array&lt;chunksize=(4, 1000, 65, 150), meta=np.ndarray&gt;
Attributes: (12/42)
    CORDEX_domain:                        NAM-44
    contact:                              {&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;Winger.Katj...
    contact_note:                         {&quot;ERA-Int.RegCM4&quot;: &quot;Simulations by ...
    creation_date:                        {&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;2015-06-18T...
    driving_experiment:                   {&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;ECMWF-ERAIN...
    driving_experiment_name:              evaluation
    ...                                   ...
    intake_esm_attrs:vertical_levels:     1
    intake_esm_attrs:bias_correction:     raw
    intake_esm_attrs:na-cordex-models:    ERA-Int.CRCM5-UQAM,ERA-Int.RegCM4,E...
    intake_esm_attrs:path:                s3://ncar-na-cordex/day/tmax.eval.d...
    intake_esm_attrs:_data_format_:       zarr
    intake_esm_dataset_key:               tmax.day.eval.NAM-44i.raw</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-06db6b90-97d2-4d5c-82d4-5e723eebb55f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-06db6b90-97d2-4d5c-82d4-5e723eebb55f' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 129</li><li><span class='xr-has-index'>lon</span>: 300</li><li><span class='xr-has-index'>member_id</span>: 6</li><li><span class='xr-has-index'>time</span>: 13514</li><li><span>bnds</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-dfce9d6c-d320-4fab-8313-7f3ffaa0fe13' class='xr-section-summary-in' type='checkbox'  checked><label for='section-dfce9d6c-d320-4fab-8313-7f3ffaa0fe13' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>12.25 12.75 13.25 ... 75.75 76.25</div><input id='attrs-8931e381-8f27-4bac-90f5-db195f67ebcf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8931e381-8f27-4bac-90f5-db195f67ebcf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5055ad22-4e12-4efa-be4d-94aea20e2b4f' class='xr-var-data-in' type='checkbox'><label for='data-5055ad22-4e12-4efa-be4d-94aea20e2b4f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([12.25, 12.75, 13.25, 13.75, 14.25, 14.75, 15.25, 15.75, 16.25, 16.75,
       17.25, 17.75, 18.25, 18.75, 19.25, 19.75, 20.25, 20.75, 21.25, 21.75,
       22.25, 22.75, 23.25, 23.75, 24.25, 24.75, 25.25, 25.75, 26.25, 26.75,
       27.25, 27.75, 28.25, 28.75, 29.25, 29.75, 30.25, 30.75, 31.25, 31.75,
       32.25, 32.75, 33.25, 33.75, 34.25, 34.75, 35.25, 35.75, 36.25, 36.75,
       37.25, 37.75, 38.25, 38.75, 39.25, 39.75, 40.25, 40.75, 41.25, 41.75,
       42.25, 42.75, 43.25, 43.75, 44.25, 44.75, 45.25, 45.75, 46.25, 46.75,
       47.25, 47.75, 48.25, 48.75, 49.25, 49.75, 50.25, 50.75, 51.25, 51.75,
       52.25, 52.75, 53.25, 53.75, 54.25, 54.75, 55.25, 55.75, 56.25, 56.75,
       57.25, 57.75, 58.25, 58.75, 59.25, 59.75, 60.25, 60.75, 61.25, 61.75,
       62.25, 62.75, 63.25, 63.75, 64.25, 64.75, 65.25, 65.75, 66.25, 66.75,
       67.25, 67.75, 68.25, 68.75, 69.25, 69.75, 70.25, 70.75, 71.25, 71.75,
       72.25, 72.75, 73.25, 73.75, 74.25, 74.75, 75.25, 75.75, 76.25])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-171.8 -171.2 ... -22.75 -22.25</div><input id='attrs-c5f9cd42-feab-45a1-9f32-bdd4b7cd86f6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c5f9cd42-feab-45a1-9f32-bdd4b7cd86f6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a03aa91e-9011-475a-82f3-4189c6c18288' class='xr-var-data-in' type='checkbox'><label for='data-a03aa91e-9011-475a-82f3-4189c6c18288' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([-171.75, -171.25, -170.75, ...,  -23.25,  -22.75,  -22.25], shape=(300,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>member_id</span></div><div class='xr-var-dims'>(member_id)</div><div class='xr-var-dtype'>&lt;U18</div><div class='xr-var-preview xr-preview'>&#x27;ERA-Int.CRCM5-UQAM&#x27; ... &#x27;ERA-In...</div><input id='attrs-4415edb5-b0e0-47e2-a781-b2836c1a90b0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4415edb5-b0e0-47e2-a781-b2836c1a90b0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d33948f8-b2bd-404a-bac9-e41ddab208a5' class='xr-var-data-in' type='checkbox'><label for='data-d33948f8-b2bd-404a-bac9-e41ddab208a5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;ERA-Int.CRCM5-UQAM&#x27;, &#x27;ERA-Int.RegCM4&#x27;, &#x27;ERA-Int.HIRHAM5&#x27;,
       &#x27;ERA-Int.RCA4&#x27;, &#x27;ERA-Int.CanRCM4&#x27;, &#x27;ERA-Int.WRF&#x27;], dtype=&#x27;&lt;U18&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1979-01-01T12:00:00 ... 2015-12-...</div><input id='attrs-49e36a7e-4449-4cd6-afa0-2602add40a0c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-49e36a7e-4449-4cd6-afa0-2602add40a0c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-203daeda-05f5-475d-bff8-630cb2e21469' class='xr-var-data-in' type='checkbox'><label for='data-203daeda-05f5-475d-bff8-630cb2e21469' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>coordinate_defines :</span></dt><dd>point</dd><dt><span>delta_t :</span></dt><dd>0000-00-01 00:00:00</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1979-01-01T12:00:00.000000000&#x27;, &#x27;1979-01-02T12:00:00.000000000&#x27;,
       &#x27;1979-01-03T12:00:00.000000000&#x27;, ..., &#x27;2015-12-29T12:00:00.000000000&#x27;,
       &#x27;2015-12-30T12:00:00.000000000&#x27;, &#x27;2015-12-31T12:00:00.000000000&#x27;],
      shape=(13514,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time, bnds)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(13514, 2), meta=np.ndarray&gt;</div><input id='attrs-c9b05eb3-d825-4daf-bd7b-3da1961e4a28' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c9b05eb3-d825-4daf-bd7b-3da1961e4a28' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4d14c680-a2c2-4780-ab82-ca7916593e7e' class='xr-var-data-in' type='checkbox'><label for='data-4d14c680-a2c2-4780-ab82-ca7916593e7e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 211.16 kiB </td>
                        <td> 211.16 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (13514, 2) </td>
                        <td> (13514, 2) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> datetime64[ns] numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="75" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="25" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
  <text x="45.412617" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,45.412617,60.000000)">13514</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-b41256b4-f682-4a11-87cb-5001fe2f4504' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b41256b4-f682-4a11-87cb-5001fe2f4504' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tmax</span></div><div class='xr-var-dims'>(member_id, time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(4, 1000, 65, 150), meta=np.ndarray&gt;</div><input id='attrs-fad82e20-5708-41cf-b5a2-5823aa2552f0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fad82e20-5708-41cf-b5a2-5823aa2552f0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1d4f7067-9590-4997-a3f0-0f33f9dc76e1' class='xr-var-data-in' type='checkbox'><label for='data-1d4f7067-9590-4997-a3f0-0f33f9dc76e1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: maximum</dd><dt><span>long_name :</span></dt><dd>Daily Maximum Near-Surface Air Temperature</dd><dt><span>remap :</span></dt><dd>remapped via ESMF_regrid_with_weights: Higher-order Patch</dd><dt><span>standard_name :</span></dt><dd>air_temperature</dd><dt><span>units :</span></dt><dd>degC</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 11.69 GiB </td>
                        <td> 148.77 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (6, 13514, 129, 300) </td>
                        <td> (4, 1000, 65, 150) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 112 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="340" height="146" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="16" y1="0" x2="16" y2="25" />
  <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >6</text>
  <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="165" y2="70" style="stroke-width:2" />
  <line x1="95" y1="12" x2="165" y2="83" />
  <line x1="95" y1="25" x2="165" y2="96" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="95" y2="25" style="stroke-width:2" />
  <line x1="100" y1="5" x2="100" y2="30" />
  <line x1="105" y1="10" x2="105" y2="35" />
  <line x1="110" y1="15" x2="110" y2="41" />
  <line x1="115" y1="20" x2="115" y2="46" />
  <line x1="121" y1="26" x2="121" y2="51" />
  <line x1="126" y1="31" x2="126" y2="56" />
  <line x1="131" y1="36" x2="131" y2="61" />
  <line x1="136" y1="41" x2="136" y2="67" />
  <line x1="142" y1="47" x2="142" y2="72" />
  <line x1="147" y1="52" x2="147" y2="77" />
  <line x1="152" y1="57" x2="152" y2="82" />
  <line x1="157" y1="62" x2="157" y2="88" />
  <line x1="162" y1="67" x2="162" y2="93" />
  <line x1="165" y1="70" x2="165" y2="96" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 165.58823529411765,70.58823529411765 165.58823529411765,96.00085180870013 95.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="124" y2="0" style="stroke-width:2" />
  <line x1="100" y1="5" x2="129" y2="5" />
  <line x1="105" y1="10" x2="135" y2="10" />
  <line x1="110" y1="15" x2="140" y2="15" />
  <line x1="115" y1="20" x2="145" y2="20" />
  <line x1="121" y1="26" x2="150" y2="26" />
  <line x1="126" y1="31" x2="155" y2="31" />
  <line x1="131" y1="36" x2="161" y2="36" />
  <line x1="136" y1="41" x2="166" y2="41" />
  <line x1="142" y1="47" x2="171" y2="47" />
  <line x1="147" y1="52" x2="176" y2="52" />
  <line x1="152" y1="57" x2="182" y2="57" />
  <line x1="157" y1="62" x2="187" y2="62" />
  <line x1="162" y1="67" x2="192" y2="67" />
  <line x1="165" y1="70" x2="195" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="165" y2="70" style="stroke-width:2" />
  <line x1="109" y1="0" x2="180" y2="70" />
  <line x1="124" y1="0" x2="195" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 124.62336131801064,0.0 195.2115966121283,70.58823529411765 165.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="165" y1="70" x2="195" y2="70" style="stroke-width:2" />
  <line x1="165" y1="83" x2="195" y2="83" />
  <line x1="165" y1="96" x2="195" y2="96" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="165" y1="70" x2="165" y2="96" style="stroke-width:2" />
  <line x1="180" y1="70" x2="180" y2="96" />
  <line x1="195" y1="70" x2="195" y2="96" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="165.58823529411765,70.58823529411765 195.2115966121283,70.58823529411765 195.2115966121283,96.00085180870013 165.58823529411765,96.00085180870013" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="180.399916" y="116.000852" font-size="1.0rem" font-weight="100" text-anchor="middle" >300</text>
  <text x="215.211597" y="83.294544" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,215.211597,83.294544)">129</text>
  <text x="120.294118" y="80.706734" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,120.294118,80.706734)">13514</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-b8ca6e6c-ceee-4e07-b672-e66fceced142' class='xr-section-summary-in' type='checkbox'  ><label for='section-b8ca6e6c-ceee-4e07-b672-e66fceced142' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-7d14f17e-cadf-4c7f-9738-273af1f73833' class='xr-index-data-in' type='checkbox'/><label for='index-7d14f17e-cadf-4c7f-9738-273af1f73833' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([12.25, 12.75, 13.25, 13.75, 14.25, 14.75, 15.25, 15.75, 16.25, 16.75,
       ...
       71.75, 72.25, 72.75, 73.25, 73.75, 74.25, 74.75, 75.25, 75.75, 76.25],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=129))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-4fa80a29-c592-41d3-8a2d-86cc3eefbbb8' class='xr-index-data-in' type='checkbox'/><label for='index-4fa80a29-c592-41d3-8a2d-86cc3eefbbb8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-171.75, -171.25, -170.75, -170.25, -169.75, -169.25, -168.75, -168.25,
       -167.75, -167.25,
       ...
        -26.75,  -26.25,  -25.75,  -25.25,  -24.75,  -24.25,  -23.75,  -23.25,
        -22.75,  -22.25],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=300))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>member_id</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-453f95ff-edad-46b4-bf60-395fafdf5f87' class='xr-index-data-in' type='checkbox'/><label for='index-453f95ff-edad-46b4-bf60-395fafdf5f87' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;ERA-Int.CRCM5-UQAM&#x27;, &#x27;ERA-Int.RegCM4&#x27;, &#x27;ERA-Int.HIRHAM5&#x27;,
       &#x27;ERA-Int.RCA4&#x27;, &#x27;ERA-Int.CanRCM4&#x27;, &#x27;ERA-Int.WRF&#x27;],
      dtype=&#x27;object&#x27;, name=&#x27;member_id&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-82f8be32-418b-48a2-bb5e-a06943c8c79d' class='xr-index-data-in' type='checkbox'/><label for='index-82f8be32-418b-48a2-bb5e-a06943c8c79d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1979-01-01 12:00:00&#x27;, &#x27;1979-01-02 12:00:00&#x27;,
               &#x27;1979-01-03 12:00:00&#x27;, &#x27;1979-01-04 12:00:00&#x27;,
               &#x27;1979-01-05 12:00:00&#x27;, &#x27;1979-01-06 12:00:00&#x27;,
               &#x27;1979-01-07 12:00:00&#x27;, &#x27;1979-01-08 12:00:00&#x27;,
               &#x27;1979-01-09 12:00:00&#x27;, &#x27;1979-01-10 12:00:00&#x27;,
               ...
               &#x27;2015-12-22 12:00:00&#x27;, &#x27;2015-12-23 12:00:00&#x27;,
               &#x27;2015-12-24 12:00:00&#x27;, &#x27;2015-12-25 12:00:00&#x27;,
               &#x27;2015-12-26 12:00:00&#x27;, &#x27;2015-12-27 12:00:00&#x27;,
               &#x27;2015-12-28 12:00:00&#x27;, &#x27;2015-12-29 12:00:00&#x27;,
               &#x27;2015-12-30 12:00:00&#x27;, &#x27;2015-12-31 12:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=13514, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b7173266-d7a5-4187-a8c7-922939d14ba3' class='xr-section-summary-in' type='checkbox'  ><label for='section-b7173266-d7a5-4187-a8c7-922939d14ba3' class='xr-section-summary' >Attributes: <span>(42)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CORDEX_domain :</span></dt><dd>NAM-44</dd><dt><span>contact :</span></dt><dd>{&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;Winger.Katja@uqam.ca&quot;, &quot;ERA-Int.RegCM4&quot;: &quot;Daryl Herzmann, akrherz@iastate.edu&quot;, &quot;ERA-Int.HIRHAM5&quot;: &quot;obc@dmi.dk&quot;, &quot;ERA-Int.RCA4&quot;: &quot;rossby.cordex@smhi.se&quot;, &quot;ERA-Int.CanRCM4&quot;: &quot;cccma_info@ec.gc.ca&quot;, &quot;ERA-Int.WRF&quot;: &quot;Melissa Bukovsky, bukovsky@ucar.edu&quot;}</dd><dt><span>contact_note :</span></dt><dd>{&quot;ERA-Int.RegCM4&quot;: &quot;Simulations by Ray Arritt (deceased)&quot;, &quot;ERA-Int.WRF&quot;: &quot;Simulations by Hsin-I Chang, hchang@atmo.arizona.edu&quot;}</dd><dt><span>creation_date :</span></dt><dd>{&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;2015-06-18T10:56:49Z&quot;, &quot;ERA-Int.RegCM4&quot;: &quot;2013-11-16T21:18:29Z&quot;, &quot;ERA-Int.HIRHAM5&quot;: &quot;2012-09-28 12:11:10&quot;, &quot;ERA-Int.RCA4&quot;: &quot;2014-02-16-T00:49:00Z&quot;, &quot;ERA-Int.CanRCM4&quot;: &quot;2012-06-29 14:22:09&quot;, &quot;ERA-Int.WRF&quot;: &quot;2016-02-29T09:37:24Z&quot;}</dd><dt><span>driving_experiment :</span></dt><dd>{&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;ECMWF-ERAINT, evaluation, r1i1p1&quot;, &quot;ERA-Int.RegCM4&quot;: &quot;ECMWF-ERAINT, evaluation, r1i1p1&quot;, &quot;ERA-Int.HIRHAM5&quot;: &quot;ECMWF-ERAINT,evaluation,r1i1p1&quot;, &quot;ERA-Int.RCA4&quot;: &quot;ECMWF-ERAINT, evaluation, r1i1p1&quot;, &quot;ERA-Int.CanRCM4&quot;: &quot;ECMWF-ERAINT, evaluation, r1i1p1&quot;, &quot;ERA-Int.WRF&quot;: &quot;ECMWF-ERAINT,evaluation,r1i1p1&quot;}</dd><dt><span>driving_experiment_name :</span></dt><dd>evaluation</dd><dt><span>driving_model_ensemble_member :</span></dt><dd>{&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;r1i1p1&quot;, &quot;ERA-Int.RegCM4&quot;: &quot;r1i1p1&quot;, &quot;ERA-Int.HIRHAM5&quot;: &quot;r1i1p1&quot;, &quot;ERA-Int.RCA4&quot;: &quot;r1i1p1&quot;, &quot;ERA-Int.CanRCM4&quot;: &quot;r1i1p1&quot;, &quot;ERA-Int.WRF&quot;: &quot;r1i1p1&quot;}</dd><dt><span>driving_model_id :</span></dt><dd>{&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;ECMWF-ERAINT&quot;, &quot;ERA-Int.RegCM4&quot;: &quot;ECMWF-ERAINT&quot;, &quot;ERA-Int.HIRHAM5&quot;: &quot;ECMWF-ERAINT&quot;, &quot;ERA-Int.RCA4&quot;: &quot;ECMWF-ERAINT&quot;, &quot;ERA-Int.CanRCM4&quot;: &quot;ECMWF-ERAINT&quot;, &quot;ERA-Int.WRF&quot;: &quot;ECMWF-ERAINT&quot;}</dd><dt><span>experiment_id :</span></dt><dd>evaluation</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>id :</span></dt><dd>doi:10.5065/D6SJ1JCH</dd><dt><span>institute_id :</span></dt><dd>{&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;UQAM&quot;, &quot;ERA-Int.RegCM4&quot;: &quot;ISU&quot;, &quot;ERA-Int.HIRHAM5&quot;: &quot;DMI&quot;, &quot;ERA-Int.RCA4&quot;: &quot;SMHI&quot;, &quot;ERA-Int.CanRCM4&quot;: &quot;CCCma&quot;, &quot;ERA-Int.WRF&quot;: &quot;UA&quot;}</dd><dt><span>institution :</span></dt><dd>{&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;Universite du Quebec a Montreal&quot;, &quot;ERA-Int.RegCM4&quot;: &quot;Iowa State University&quot;, &quot;ERA-Int.HIRHAM5&quot;: &quot;Danish Meteorological Institute&quot;, &quot;ERA-Int.RCA4&quot;: &quot;Swedish Meteorological and Hydrological Institute, Rossby Centre&quot;, &quot;ERA-Int.CanRCM4&quot;: &quot;CCCma (Canadian Centre for Climate Modelling and Analysis, Victoria, BC, Canada)&quot;, &quot;ERA-Int.WRF&quot;: &quot;University of Arizona&quot;}</dd><dt><span>model_id :</span></dt><dd>{&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;UQAM-CRCM5&quot;, &quot;ERA-Int.RegCM4&quot;: &quot;ISU-RegCM4&quot;, &quot;ERA-Int.HIRHAM5&quot;: &quot;DMI-HIRHAM5&quot;, &quot;ERA-Int.RCA4&quot;: &quot;SMHI-RCA4&quot;, &quot;ERA-Int.CanRCM4&quot;: &quot;CCCma-CanRCM4&quot;, &quot;ERA-Int.WRF&quot;: &quot;UA-WRF&quot;}</dd><dt><span>original_calendar :</span></dt><dd>{&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;gregorian&quot;, &quot;ERA-Int.RegCM4&quot;: &quot;standard&quot;, &quot;ERA-Int.HIRHAM5&quot;: &quot;gregorian&quot;, &quot;ERA-Int.RCA4&quot;: &quot;standard&quot;, &quot;ERA-Int.CanRCM4&quot;: &quot;365_day&quot;, &quot;ERA-Int.WRF&quot;: &quot;standard&quot;}</dd><dt><span>product :</span></dt><dd>output</dd><dt><span>project_id :</span></dt><dd>CORDEX</dd><dt><span>rcm_version_id :</span></dt><dd>{&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;v1&quot;, &quot;ERA-Int.RegCM4&quot;: &quot;v4.4-rc8&quot;, &quot;ERA-Int.HIRHAM5&quot;: &quot;v1&quot;, &quot;ERA-Int.RCA4&quot;: &quot;v1&quot;, &quot;ERA-Int.CanRCM4&quot;: &quot;r2&quot;, &quot;ERA-Int.WRF&quot;: &quot;v3.5.1&quot;}</dd><dt><span>references :</span></dt><dd>{&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;http://www.mrcc.uqam.ca&quot;, &quot;ERA-Int.RegCM4&quot;: &quot;Elguindi, et al. Regional climate model RegCM user manual version 4.4. The Abdus Salam International Centre for Theoretical Physics, Strada Costiera, Trieste, Italy. (2013).&quot;, &quot;ERA-Int.HIRHAM5&quot;: &quot;Christensen, et al. \&quot;The HIRHAM regional climate model. Version 5 (beta).\&quot; (2007).&quot;, &quot;ERA-Int.RCA4&quot;: &quot;http://www.smhi.se/en/Research/Research-departments/climate-research-rossby-centre&quot;, &quot;ERA-Int.CanRCM4&quot;: &quot;http://www.cccma.ec.gc.ca/models&quot;, &quot;ERA-Int.WRF&quot;: &quot;Skamarock, et al., 2005. &#x27;A description of the Advanced Research WRF version 2.&#x27; NCAR Tech. Note NCAR/TN-468+STR&quot;}</dd><dt><span>title :</span></dt><dd>{&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;NA-CORDEX Raw NAM-44i CRCM5-UQAM ERA-Int Eval Daily Mean Daily Max 2m Temperature&quot;, &quot;ERA-Int.RegCM4&quot;: &quot;NA-CORDEX Raw NAM-44i RegCM4 ERA-Int Eval Daily Mean Daily Max 2m Temperature&quot;, &quot;ERA-Int.HIRHAM5&quot;: &quot;NA-CORDEX Raw NAM-44i HIRHAM5 ERA-Int Eval Daily Mean Daily Max 2m Temperature&quot;, &quot;ERA-Int.RCA4&quot;: &quot;NA-CORDEX Raw NAM-44i RCA4 ERA-Int Eval Daily Mean Daily Max 2m Temperature&quot;, &quot;ERA-Int.CanRCM4&quot;: &quot;NA-CORDEX Raw NAM-44i CanRCM4 ERA-Int Eval Daily Mean Daily Max 2m Temperature&quot;, &quot;ERA-Int.WRF&quot;: &quot;NA-CORDEX Raw NAM-44i WRF ERA-Int Eval Daily Mean Daily Max 2m Temperature&quot;}</dd><dt><span>tracking_id :</span></dt><dd>{&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;a8d17321-0e16-46eb-b8e1-a419ab582dbf&quot;, &quot;ERA-Int.RegCM4&quot;: &quot;52329c90-c89c-4780-b154-0244cc969507&quot;, &quot;ERA-Int.HIRHAM5&quot;: &quot;f02ffa94-2fe0-4d67-b98e-fa58ca57eb4d&quot;, &quot;ERA-Int.RCA4&quot;: &quot;4ea53413-f7e3-4135-97f3-4d4446b57431&quot;, &quot;ERA-Int.CanRCM4&quot;: &quot;41a6bfca-ac24-4dfd-8dce-1c5c47416ae5&quot;, &quot;ERA-Int.WRF&quot;: &quot;c6e0f951-7ead-4e41-8a7c-2ba34a2450d9&quot;}</dd><dt><span>version :</span></dt><dd>{&quot;ERA-Int.CRCM5-UQAM&quot;: &quot;1.2&quot;, &quot;ERA-Int.RegCM4&quot;: &quot;2.1&quot;, &quot;ERA-Int.HIRHAM5&quot;: &quot;1.2&quot;, &quot;ERA-Int.RCA4&quot;: &quot;1.1&quot;, &quot;ERA-Int.CanRCM4&quot;: &quot;1.2&quot;, &quot;ERA-Int.WRF&quot;: &quot;2.3&quot;}</dd><dt><span>zarr-dataset-reference :</span></dt><dd>For dataset documentation, see DOI https://doi.org/10.5065/D6SJ1JCH</dd><dt><span>zarr-version :</span></dt><dd>1.0</dd><dt><span>intake_esm_vars :</span></dt><dd>[&#x27;tmax&#x27;]</dd><dt><span>intake_esm_attrs:variable :</span></dt><dd>tmax</dd><dt><span>intake_esm_attrs:standard_name :</span></dt><dd>air_temperature</dd><dt><span>intake_esm_attrs:long_name :</span></dt><dd>Daily Maximum Near-Surface Air Temperature</dd><dt><span>intake_esm_attrs:units :</span></dt><dd>degC</dd><dt><span>intake_esm_attrs:spatial_domain :</span></dt><dd>north_america</dd><dt><span>intake_esm_attrs:grid :</span></dt><dd>NAM-44i</dd><dt><span>intake_esm_attrs:spatial_resolution :</span></dt><dd>0.50 deg</dd><dt><span>intake_esm_attrs:scenario :</span></dt><dd>eval</dd><dt><span>intake_esm_attrs:start_time :</span></dt><dd>1979-01-01T12:00:00</dd><dt><span>intake_esm_attrs:end_time :</span></dt><dd>2015-12-31T12:00:00</dd><dt><span>intake_esm_attrs:frequency :</span></dt><dd>day</dd><dt><span>intake_esm_attrs:vertical_levels :</span></dt><dd>1</dd><dt><span>intake_esm_attrs:bias_correction :</span></dt><dd>raw</dd><dt><span>intake_esm_attrs:na-cordex-models :</span></dt><dd>ERA-Int.CRCM5-UQAM,ERA-Int.RegCM4,ERA-Int.HIRHAM5,ERA-Int.RCA4,ERA-Int.CanRCM4,ERA-Int.WRF</dd><dt><span>intake_esm_attrs:path :</span></dt><dd>s3://ncar-na-cordex/day/tmax.eval.day.NAM-44i.raw.zarr</dd><dt><span>intake_esm_attrs:_data_format_ :</span></dt><dd>zarr</dd><dt><span>intake_esm_dataset_key :</span></dt><dd>tmax.day.eval.NAM-44i.raw</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
</section>
<section id="functions-for-subsetting-and-plotting">
<h2>Functions for Subsetting and Plotting<a class="headerlink" href="#functions-for-subsetting-and-plotting" title="Link to this heading">#</a></h2>
<section id="helper-function-to-create-a-single-map-plot">
<h3>Helper Function to Create a Single Map Plot<a class="headerlink" href="#helper-function-to-create-a-single-map-plot" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plotMap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">map_slice</span><span class="p">,</span> <span class="n">date_object</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">member_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a map plot on the given axes, with min/max as text&quot;&quot;&quot;</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">map_slice</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>

    <span class="n">minval</span> <span class="o">=</span> <span class="n">map_slice</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>
    <span class="n">maxval</span> <span class="o">=</span> <span class="n">map_slice</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>

    <span class="c1"># Format values to have at least 4 digits of precision.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;Min: </span><span class="si">%3g</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">minval</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;Max: </span><span class="si">%3g</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">maxval</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    
    <span class="k">if</span> <span class="n">date_object</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">date_object</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)[:</span><span class="mi">10</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="n">member_id</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">member_id</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">ax</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="helper-function-for-finding-dates-with-available-data">
<h3>Helper Function for Finding Dates with Available Data<a class="headerlink" href="#helper-function-for-finding-dates-with-available-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">getValidDateIndexes</span><span class="p">(</span><span class="n">member_slice</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Search for the first and last dates with finite values.&quot;&quot;&quot;</span>
    <span class="n">min_values</span> <span class="o">=</span> <span class="n">member_slice</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>
    <span class="n">is_finite</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">min_values</span><span class="p">)</span>
    <span class="n">finite_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_finite</span><span class="p">)</span>

    <span class="n">start_index</span> <span class="o">=</span> <span class="n">finite_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">end_index</span> <span class="o">=</span> <span class="n">finite_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">start_index</span><span class="p">,</span> <span class="n">end_index</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="helper-function-for-truncating-data-slices">
<h3>Helper Function for Truncating Data Slices<a class="headerlink" href="#helper-function-for-truncating-data-slices" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">truncateData</span><span class="p">(</span><span class="n">data_slice</span><span class="p">,</span> <span class="n">num_years</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove all but the first num_years of valid data from the data slice.&quot;&quot;&quot;</span>
    <span class="n">start_index</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">getValidDateIndexes</span><span class="p">(</span><span class="n">data_slice</span><span class="p">)</span>
    <span class="n">start_date</span> <span class="o">=</span> <span class="n">data_slice</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">start_index</span><span class="p">]</span>
    <span class="n">start_year</span> <span class="o">=</span> <span class="n">start_date</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">values</span>
    <span class="n">year_range</span> <span class="o">=</span> <span class="n">start_year</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_years</span><span class="p">)</span>
    
    <span class="n">data_slice</span> <span class="o">=</span> <span class="n">data_slice</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">year_range</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">data_slice</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="function-producing-maps-of-first-middle-and-final-timesteps">
<h3>Function Producing Maps of First, Middle, and Final Timesteps<a class="headerlink" href="#function-producing-maps-of-first-middle-and-final-timesteps" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_first_mid_last</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">data_var</span><span class="p">,</span> <span class="n">store_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the first, middle, and final time steps for several climate runs.&quot;&quot;&quot;</span>
    <span class="n">num_members_to_plot</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">member_names</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;member_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">num_members_to_plot</span><span class="p">]</span>
    
    <span class="n">figWidth</span> <span class="o">=</span> <span class="mi">18</span> 
    <span class="n">figHeight</span> <span class="o">=</span> <span class="mi">12</span> 
    <span class="n">numPlotColumns</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num_members_to_plot</span><span class="p">,</span> <span class="n">numPlotColumns</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">figWidth</span><span class="p">,</span> <span class="n">figHeight</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_members_to_plot</span><span class="p">):</span>
        <span class="n">mem_id</span> <span class="o">=</span> <span class="n">member_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">data_slice</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">data_var</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">member_id</span><span class="o">=</span><span class="n">mem_id</span><span class="p">)</span>
           
        <span class="n">start_index</span><span class="p">,</span> <span class="n">end_index</span> <span class="o">=</span> <span class="n">getValidDateIndexes</span><span class="p">(</span><span class="n">data_slice</span><span class="p">)</span>
        <span class="n">midDateIndex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="n">startDate</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">start_index</span><span class="p">]</span>
        <span class="n">first_step</span> <span class="o">=</span> <span class="n">data_slice</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">startDate</span><span class="p">)</span> 
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">plotMap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">first_step</span><span class="p">,</span> <span class="n">startDate</span><span class="p">,</span> <span class="n">mem_id</span><span class="p">)</span>

        <span class="n">midDate</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">midDateIndex</span><span class="p">]</span>
        <span class="n">mid_step</span> <span class="o">=</span> <span class="n">data_slice</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">midDate</span><span class="p">)</span>   
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">plotMap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">mid_step</span><span class="p">,</span> <span class="n">midDate</span><span class="p">)</span>

        <span class="n">endDate</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">end_index</span><span class="p">]</span>
        <span class="n">last_step</span> <span class="o">=</span> <span class="n">data_slice</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">endDate</span><span class="p">)</span>            
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">plotMap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">last_step</span><span class="p">,</span> <span class="n">endDate</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;First, Middle, and Last Timesteps for Selected Runs in &quot;</span><span class="si">{</span><span class="n">store_name</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="function-producing-statistical-map-plots">
<h3>Function Producing Statistical Map Plots<a class="headerlink" href="#function-producing-statistical-map-plots" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_stat_maps</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">data_var</span><span class="p">,</span> <span class="n">store_name</span><span class="p">,</span> <span class="n">truncate_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the mean, min, max, and standard deviation values for several climate runs, aggregated over time.&quot;&quot;&quot;</span>
    
    <span class="n">num_members_to_plot</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">member_names</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;member_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">num_members_to_plot</span><span class="p">]</span>

    <span class="n">figWidth</span> <span class="o">=</span> <span class="mi">25</span> 
    <span class="n">figHeight</span> <span class="o">=</span> <span class="mi">12</span> 
    <span class="n">numPlotColumns</span> <span class="o">=</span> <span class="mi">4</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num_members_to_plot</span><span class="p">,</span> <span class="n">numPlotColumns</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">figWidth</span><span class="p">,</span> <span class="n">figHeight</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_members_to_plot</span><span class="p">):</span>
        <span class="n">mem_id</span> <span class="o">=</span> <span class="n">member_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">data_slice</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">data_var</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">member_id</span><span class="o">=</span><span class="n">mem_id</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">truncate_data</span><span class="p">:</span>
            <span class="c1"># Limit time range to one year.</span>
            <span class="n">data_slice</span> <span class="o">=</span> <span class="n">truncateData</span><span class="p">(</span><span class="n">data_slice</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Save slice in memory to prevent repeated disk loads</span>
        <span class="n">data_slice</span> <span class="o">=</span> <span class="n">data_slice</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>

        <span class="n">data_agg</span> <span class="o">=</span> <span class="n">data_slice</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="n">plotMap</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">data_agg</span><span class="p">,</span> <span class="n">member_id</span><span class="o">=</span><span class="n">mem_id</span><span class="p">)</span>

        <span class="n">data_agg</span> <span class="o">=</span> <span class="n">data_slice</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="n">plotMap</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">data_agg</span><span class="p">)</span>

        <span class="n">data_agg</span> <span class="o">=</span> <span class="n">data_slice</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="n">plotMap</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">data_agg</span><span class="p">)</span>

        <span class="n">data_agg</span> <span class="o">=</span> <span class="n">data_slice</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="n">plotMap</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">data_agg</span><span class="p">)</span>

    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;min(</span><span class="si">{</span><span class="n">data_var</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;max(</span><span class="si">{</span><span class="n">data_var</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean(</span><span class="si">{</span><span class="n">data_var</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;std(</span><span class="si">{</span><span class="n">data_var</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Spatial Statistics for Selected Runs in &quot;</span><span class="si">{</span><span class="n">store_name</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="function-producing-time-series-plots">
<h3>Function Producing Time Series Plots<a class="headerlink" href="#function-producing-time-series-plots" title="Link to this heading">#</a></h3>
<p>Also show which dates have no available data values, as a rug plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_timeseries</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">data_var</span><span class="p">,</span> <span class="n">store_name</span><span class="p">,</span> <span class="n">truncate_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the mean, min, max, and standard deviation values for several climate runs, </span>
<span class="sd">       aggregated over lat/lon dimensions.&quot;&quot;&quot;</span>

    <span class="n">num_members_to_plot</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">member_names</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;member_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">num_members_to_plot</span><span class="p">]</span>

    <span class="n">figWidth</span> <span class="o">=</span> <span class="mi">25</span> 
    <span class="n">figHeight</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span>

    <span class="n">numPlotColumns</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num_members_to_plot</span><span class="p">,</span> <span class="n">numPlotColumns</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">figWidth</span><span class="p">,</span> <span class="n">figHeight</span><span class="p">))</span>
        
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_members_to_plot</span><span class="p">):</span>
        <span class="n">mem_id</span> <span class="o">=</span> <span class="n">member_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">data_slice</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">data_var</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">member_id</span><span class="o">=</span><span class="n">mem_id</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">truncate_data</span><span class="p">:</span>
            <span class="c1"># Limit time range to one year.</span>
            <span class="n">data_slice</span> <span class="o">=</span> <span class="n">truncateData</span><span class="p">(</span><span class="n">data_slice</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Save slice in memory to prevent repeated disk loads</span>
        <span class="n">data_slice</span> <span class="o">=</span> <span class="n">data_slice</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>

        <span class="n">unit_string</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">data_var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span>
        
        <span class="n">min_vals</span> <span class="o">=</span> <span class="n">data_slice</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>
        <span class="n">max_vals</span> <span class="o">=</span> <span class="n">data_slice</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>
        <span class="n">mean_vals</span> <span class="o">=</span> <span class="n">data_slice</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>
        <span class="n">std_vals</span> <span class="o">=</span> <span class="n">data_slice</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>

        <span class="n">missing_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">min_vals</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
        <span class="n">missing_times</span> <span class="o">=</span> <span class="n">data_slice</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">missing_indexes</span><span class="p">]</span>

            
        <span class="n">axs</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_slice</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">max_vals</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_slice</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">mean_vals</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">data_slice</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="p">(</span><span class="n">mean_vals</span> <span class="o">-</span> <span class="n">std_vals</span><span class="p">),</span> <span class="p">(</span><span class="n">mean_vals</span> <span class="o">+</span> <span class="n">std_vals</span><span class="p">),</span> 
                                         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_slice</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">min_vals</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            
        <span class="c1"># Produce a rug plot along the bottom of the figure for missing data.</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">rug_y</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">+</span> <span class="mf">0.01</span><span class="o">*</span><span class="p">(</span><span class="n">ymax</span><span class="o">-</span><span class="n">ymin</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">missing_times</span><span class="p">,</span> <span class="p">[</span><span class="n">rug_y</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_times</span><span class="p">),</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;missing&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">mem_id</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">unit_string</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">10.2</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">3.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Temporal Statistics for Selected Runs in &quot;</span><span class="si">{</span><span class="n">store_name</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="produce-diagnostic-plots">
<h2>Produce Diagnostic Plots<a class="headerlink" href="#produce-diagnostic-plots" title="Link to this heading">#</a></h2>
<section id="plot-first-middle-and-final-timesteps-for-several-output-runs-less-compute-intensive">
<h3>Plot First, Middle, and Final Timesteps for Several Output Runs (less compute intensive)<a class="headerlink" href="#plot-first-middle-and-final-timesteps-for-several-output-runs-less-compute-intensive" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="c1"># Plot using the Zarr Store obtained from an earlier step in the notebook.</span>
<span class="n">figure</span> <span class="o">=</span> <span class="n">plot_first_mid_last</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">data_var</span><span class="p">,</span> <span class="n">store_name</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-06-17 18:13:53,568 - distributed.worker.state_machine - WARNING - Async instruction for &lt;Task cancelled name=&quot;execute((&#39;getitem-open_dataset-tmax-nanmin_skip-53e32fbdb0004624feb55fe84918af79&#39;, 0, 1, 0))&quot; coro=&lt;Worker.execute() done, defined at /home/runner/micromamba/envs/na-cordex-viz-cookbook-dev/lib/python3.11/site-packages/distributed/worker_state_machine.py:3607&gt;&gt; ended with CancelledError
2025-06-17 18:13:53,569 - distributed.worker.state_machine - WARNING - Async instruction for &lt;Task cancelled name=&quot;execute((&#39;getitem-open_dataset-tmax-nanmin_skip-53e32fbdb0004624feb55fe84918af79&#39;, 0, 0, 1))&quot; coro=&lt;Worker.execute() done, defined at /home/runner/micromamba/envs/na-cordex-viz-cookbook-dev/lib/python3.11/site-packages/distributed/worker_state_machine.py:3607&gt;&gt; ended with CancelledError
2025-06-17 18:13:53,571 - distributed.worker.state_machine - WARNING - Async instruction for &lt;Task cancelled name=&quot;execute((&#39;getitem-open_dataset-tmax-nanmin_skip-53e32fbdb0004624feb55fe84918af79&#39;, 1, 1, 0))&quot; coro=&lt;Worker.execute() done, defined at /home/runner/micromamba/envs/na-cordex-viz-cookbook-dev/lib/python3.11/site-packages/distributed/worker_state_machine.py:3607&gt;&gt; ended with CancelledError
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">23</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="nn">----&gt; 1 get_ipython().run_cell_magic(&#39;time&#39;, &#39;&#39;, &#39;\n# Plot using the Zarr Store obtained from an earlier step</span> in <span class="ni">the notebook.\nfigure = plot_first_mid_last(ds, data_var, store_name)\n\nplt.show</span><span class="nt">()\n&#39;)</span>

<span class="nn">File ~/micromamba/envs/na-cordex-viz-cookbook-dev/lib/python3.11/site-packages/IPython/core/interactiveshell.py:2549,</span> in <span class="ni">InteractiveShell.run_cell_magic</span><span class="nt">(self, magic_name, line, cell)</span>
<span class="g g-Whitespace">   </span><span class="mi">2547</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">builtin_trap</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2548</span>     <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">magic_arg_s</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2549</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2551</span> <span class="c1"># The code below prevents the output from being displayed</span>
<span class="g g-Whitespace">   </span><span class="mi">2552</span> <span class="c1"># when using magics with decorator @output_can_be_silenced</span>
<span class="g g-Whitespace">   </span><span class="mi">2553</span> <span class="c1"># when the last Python token in the expression is a &#39;;&#39;.</span>
<span class="g g-Whitespace">   </span><span class="mi">2554</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">magic</span><span class="o">.</span><span class="n">MAGIC_OUTPUT_CAN_BE_SILENCED</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>

<span class="nn">File ~/micromamba/envs/na-cordex-viz-cookbook-dev/lib/python3.11/site-packages/IPython/core/magics/execution.py:1390,</span> in <span class="ni">ExecutionMagics.time</span><span class="nt">(self, line, cell, local_ns)</span>
<span class="g g-Whitespace">   </span><span class="mi">1388</span> <span class="n">st</span> <span class="o">=</span> <span class="n">clock2</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1389</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1390</span>     <span class="n">exec</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">glob</span><span class="p">,</span> <span class="n">local_ns</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1391</span>     <span class="n">out</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1392</span>     <span class="c1"># multi-line %%time case</span>

<span class="n">File</span> <span class="o">&lt;</span><span class="n">timed</span> <span class="n">exec</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">2</span>

<span class="nn">Cell In[20], line 15,</span> in <span class="ni">plot_first_mid_last</span><span class="nt">(ds, data_var, store_name)</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="n">mem_id</span> <span class="o">=</span> <span class="n">member_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="n">data_slice</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">data_var</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">member_id</span><span class="o">=</span><span class="n">mem_id</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">15</span> <span class="n">start_index</span><span class="p">,</span> <span class="n">end_index</span> <span class="o">=</span> <span class="n">getValidDateIndexes</span><span class="p">(</span><span class="n">data_slice</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span> <span class="n">midDateIndex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="n">startDate</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">start_index</span><span class="p">]</span>

<span class="nn">Cell In[18], line 5,</span> in <span class="ni">getValidDateIndexes</span><span class="nt">(member_slice)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">min_values</span> <span class="o">=</span> <span class="n">member_slice</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">is_finite</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">min_values</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">finite_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_finite</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">start_index</span> <span class="o">=</span> <span class="n">finite_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">end_index</span> <span class="o">=</span> <span class="n">finite_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="nn">File ~/micromamba/envs/na-cordex-viz-cookbook-dev/lib/python3.11/site-packages/xarray/core/common.py:181,</span> in <span class="ni">AbstractArray.__array__</span><span class="nt">(self, dtype, copy)</span>
<span class="g g-Whitespace">    </span><span class="mi">179</span>         <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">180</span>             <span class="n">copy</span> <span class="o">=</span> <span class="kc">False</span>
<span class="ne">--&gt; </span><span class="mi">181</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/na-cordex-viz-cookbook-dev/lib/python3.11/site-packages/xarray/core/dataarray.py:797,</span> in <span class="ni">DataArray.values</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">784</span> <span class="nd">@property</span>
<span class="g g-Whitespace">    </span><span class="mi">785</span> <span class="k">def</span><span class="w"> </span><span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">786</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">787</span><span class="sd">     The array&#39;s data converted to numpy.ndarray.</span>
<span class="g g-Whitespace">    </span><span class="mi">788</span><span class="sd"> </span>
<span class="sd">   (...)    795     to this array may be reflected in the DataArray as well.</span>
<span class="g g-Whitespace">    </span><span class="mi">796</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">797</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">values</span>

<span class="nn">File ~/micromamba/envs/na-cordex-viz-cookbook-dev/lib/python3.11/site-packages/xarray/core/variable.py:530,</span> in <span class="ni">Variable.values</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">527</span> <span class="nd">@property</span>
<span class="g g-Whitespace">    </span><span class="mi">528</span> <span class="k">def</span><span class="w"> </span><span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">529</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;The variable&#39;s data as a numpy.ndarray&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">530</span>     <span class="k">return</span> <span class="n">_as_array_or_item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/na-cordex-viz-cookbook-dev/lib/python3.11/site-packages/xarray/core/variable.py:315,</span> in <span class="ni">_as_array_or_item</span><span class="nt">(data)</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span> <span class="k">def</span><span class="w"> </span><span class="nf">_as_array_or_item</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">302</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Return the given values as a numpy array, or as an individual item if</span>
<span class="g g-Whitespace">    </span><span class="mi">303</span><span class="sd">     it&#39;s a 0d datetime64 or timedelta64 array.</span>
<span class="g g-Whitespace">    </span><span class="mi">304</span><span class="sd"> </span>
<span class="sd">   (...)    313     TODO: remove this (replace with np.asarray) once these issues are fixed</span>
<span class="g g-Whitespace">    </span><span class="mi">314</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">315</span>     <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">316</span>     <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">317</span>         <span class="n">kind</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span>

<span class="nn">File ~/micromamba/envs/na-cordex-viz-cookbook-dev/lib/python3.11/site-packages/dask/array/core.py:1724,</span> in <span class="ni">Array.__array__</span><span class="nt">(self, dtype, copy, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1717</span> <span class="k">if</span> <span class="n">copy</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1718</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1719</span>         <span class="s2">&quot;Can&#39;t acquire a memory view of a Dask array. &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1720</span>         <span class="s2">&quot;This will raise in the future.&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1721</span>         <span class="ne">FutureWarning</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1722</span>     <span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1724</span> <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1726</span> <span class="c1"># Apply requested dtype and convert non-numpy backends to numpy.</span>
<span class="g g-Whitespace">   </span><span class="mi">1727</span> <span class="c1"># If copy is True, numpy is going to perform its own deep copy</span>
<span class="g g-Whitespace">   </span><span class="mi">1728</span> <span class="c1"># after this method returns.</span>
<span class="g g-Whitespace">   </span><span class="mi">1729</span> <span class="c1"># If copy is None, finalize() ensures that the returned object</span>
<span class="g g-Whitespace">   </span><span class="mi">1730</span> <span class="c1"># does not share memory with an object stored in the graph or on a</span>
<span class="g g-Whitespace">   </span><span class="mi">1731</span> <span class="c1"># process-local Worker.</span>
<span class="g g-Whitespace">   </span><span class="mi">1732</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/na-cordex-viz-cookbook-dev/lib/python3.11/site-packages/dask/base.py:373,</span> in <span class="ni">DaskMethodsMixin.compute</span><span class="nt">(self, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">349</span> <span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">350</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Compute this dask collection</span>
<span class="g g-Whitespace">    </span><span class="mi">351</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">352</span><span class="sd">     This turns a lazy Dask collection into its in-memory equivalent.</span>
<span class="sd">   (...)    371     dask.compute</span>
<span class="g g-Whitespace">    </span><span class="mi">372</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">373</span>     <span class="p">(</span><span class="n">result</span><span class="p">,)</span> <span class="o">=</span> <span class="n">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">traverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">374</span>     <span class="k">return</span> <span class="n">result</span>

<span class="nn">File ~/micromamba/envs/na-cordex-viz-cookbook-dev/lib/python3.11/site-packages/dask/base.py:681,</span> in <span class="ni">compute</span><span class="nt">(traverse, optimize_graph, scheduler, get, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">678</span>     <span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">679</span>     <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">__dask_keys__</span><span class="p">()))</span>
<span class="ne">--&gt; </span><span class="mi">681</span>     <span class="n">results</span> <span class="o">=</span> <span class="n">schedule</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">683</span> <span class="k">return</span> <span class="n">repack</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="nn">File ~/micromamba/envs/na-cordex-viz-cookbook-dev/lib/python3.11/threading.py:622,</span> in <span class="ni">Event.wait</span><span class="nt">(self, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">620</span> <span class="n">signaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag</span>
<span class="g g-Whitespace">    </span><span class="mi">621</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">signaled</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">622</span>     <span class="n">signaled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cond</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">623</span> <span class="k">return</span> <span class="n">signaled</span>

<span class="nn">File ~/micromamba/envs/na-cordex-viz-cookbook-dev/lib/python3.11/threading.py:324,</span> in <span class="ni">Condition.wait</span><span class="nt">(self, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">322</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">323</span>     <span class="k">if</span> <span class="n">timeout</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">324</span>         <span class="n">gotit</span> <span class="o">=</span> <span class="n">waiter</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">325</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">326</span>         <span class="n">gotit</span> <span class="o">=</span> <span class="n">waiter</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
<img alt="../_images/e3d22d74fca83e89437e1bdd2865d2800a3f05db379c95d8a64f7577eec03e81.png" src="../_images/e3d22d74fca83e89437e1bdd2865d2800a3f05db379c95d8a64f7577eec03e81.png" />
</div>
</div>
<section id="optional-save-figure-to-a-png-file">
<h4>Optional: Save figure to a PNG file<a class="headerlink" href="#optional-save-figure-to-a-png-file" title="Link to this heading">#</a></h4>
<p>Change the value of <code class="docutils literal notranslate"><span class="pre">SAVE_PLOT</span></code> to True to produce a PNG file of the plot.   The file will be saved in the same folder as this notebook.</p>
<p>Then use Jupyter’s file browser to locate the file and right-click the file to download it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SAVE_PLOT</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">if</span> <span class="n">SAVE_PLOT</span><span class="p">:</span>
    <span class="n">plotfile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;./</span><span class="si">{</span><span class="n">dataset_key</span><span class="si">}</span><span class="s1">_FML.png&#39;</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plotfile</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="create-statistical-map-plots-for-several-output-runs-more-compute-intensive">
<h3>Create Statistical Map Plots for Several Output Runs (more compute intensive)<a class="headerlink" href="#create-statistical-map-plots-for-several-output-runs-more-compute-intensive" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="c1"># Plot using the Zarr Store obtained from an earlier step in the notebook.</span>
<span class="n">figure</span> <span class="o">=</span> <span class="n">plot_stat_maps</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">data_var</span><span class="p">,</span> <span class="n">store_name</span><span class="p">,</span> <span class="n">TRUNCATE_DATA</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h4>Optional: Save figure to a PNG file<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>Change the value of <code class="docutils literal notranslate"><span class="pre">SAVE_PLOT</span></code> to True to produce a PNG file of the plot.   The file will be saved in the same folder as this notebook.</p>
<p>Then use Jupyter’s file browser to locate the file and right-click the file to download it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SAVE_PLOT</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">if</span> <span class="n">SAVE_PLOT</span><span class="p">:</span>
    <span class="n">plotfile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;./</span><span class="si">{</span><span class="n">dataset_key</span><span class="si">}</span><span class="s1">_MAPS.png&#39;</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plotfile</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="plot-time-series-for-several-output-runs-more-compute-intensive">
<h3>Plot Time Series for Several Output Runs (more compute intensive)<a class="headerlink" href="#plot-time-series-for-several-output-runs-more-compute-intensive" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="c1"># Plot using the Zarr Store obtained from an earlier step in the notebook.</span>
<span class="n">figure</span> <span class="o">=</span> <span class="n">plot_timeseries</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">data_var</span><span class="p">,</span> <span class="n">store_name</span><span class="p">,</span> <span class="n">TRUNCATE_DATA</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h4>Optional: Save figure to a PNG file<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>Change the value of <code class="docutils literal notranslate"><span class="pre">SAVE_PLOT</span></code> to True to produce a PNG file of the plot.   The file will be saved in the same folder as this notebook.</p>
<p>Then use Jupyter’s file browser to locate the file and right-click the file to download it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SAVE_PLOT</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">if</span> <span class="n">SAVE_PLOT</span><span class="p">:</span>
    <span class="n">plotfile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;./</span><span class="si">{</span><span class="n">dataset_key</span><span class="si">}</span><span class="s1">_TS.png&#39;</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plotfile</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="release-the-workers">
<h3>Release the workers.<a class="headerlink" href="#release-the-workers" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>date
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="show-which-python-package-versions-were-used">
<h3>Show which python package versions were used<a class="headerlink" href="#show-which-python-package-versions-were-used" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark
<span class="o">%</span><span class="k">watermark</span> -iv
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="how-to-cite.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">How to Cite This Cookbook</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-user-options">Select User Options</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-cloud-storage-amazon-aws-or-ncar-cloud">Choose Cloud Storage (Amazon AWS or NCAR Cloud)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-whether-to-truncate-data-for-resource-limited-computers">Choose whether to truncate data for resource-limited computers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-whether-to-use-a-pbs-scheduler">Choose whether to use a PBS Scheduler</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-whether-to-use-dask-gateway">Choose whether to use Dask Gateway</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-and-connect-to-dask-distributed-cluster">Create and Connect to Dask Distributed Cluster</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-and-obtain-data-using-an-intake-catalog">Find and Obtain Data Using an Intake Catalog</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-intake-catalog-url-and-storage-access-options">Define the Intake Catalog URL and Storage Access Options</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#open-catalog-and-produce-a-content-summary">Open catalog and produce a content summary</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data-into-xarray-using-the-catalog">Load data into xarray using the catalog</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-for-subsetting-and-plotting">Functions for Subsetting and Plotting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-function-to-create-a-single-map-plot">Helper Function to Create a Single Map Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-function-for-finding-dates-with-available-data">Helper Function for Finding Dates with Available Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-function-for-truncating-data-slices">Helper Function for Truncating Data Slices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-producing-maps-of-first-middle-and-final-timesteps">Function Producing Maps of First, Middle, and Final Timesteps</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-producing-statistical-map-plots">Function Producing Statistical Map Plots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-producing-time-series-plots">Function Producing Time Series Plots</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#produce-diagnostic-plots">Produce Diagnostic Plots</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-first-middle-and-final-timesteps-for-several-output-runs-less-compute-intensive">Plot First, Middle, and Final Timesteps for Several Output Runs (less compute intensive)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-save-figure-to-a-png-file">Optional: Save figure to a PNG file</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-statistical-map-plots-for-several-output-runs-more-compute-intensive">Create Statistical Map Plots for Several Output Runs (more compute intensive)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Optional: Save figure to a PNG file</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-time-series-for-several-output-runs-more-compute-intensive">Plot Time Series for Several Output Runs (more compute intensive)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Optional: Save figure to a PNG file</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#release-the-workers">Release the workers.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#show-which-python-package-versions-were-used">Show which python package versions were used</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>